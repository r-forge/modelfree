<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta name="Author" content="Ivan Marin-Franch">
  <meta name="Description"
 content="Nonparametric estimates of psychometric functions">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Nonparametric estimates of psychometric functions: Documentation</title>
  <link href="styles.css" rel="stylesheet" type="text/css">
</head>
<body>
<table class="titleBox" cellpadding="0" cellspacing="0" width="100%">
  <tbody>
    <tr>
      <th scope="col" width="200"><img alt="logo"
 src="pictures/logo.jpg" style="width: 186px; height: 142px;"><br>
      </th>
      <th scope="col" bgcolor="#009933"> <h1 class="title" align="center">Model-free estimation of a psychometric function</h1>
          <blockquote>
            <h3 class="title" align="right"><script src="version.js" type="text/javascript"></script></h3>
          </blockquote></th>
    </tr>
    <tr> </tr>
  </tbody>
</table>
<table class="navigationBox" cellspacing="5" width="100%">
  <tbody>
    <tr>
      <th scope="col" width="14%"><a href="home.html"
 class="navigation">Home</a></th>
       <th scope="col" width="14%"><a href="downloads.html"
 class="navigation">Downloads</a></th>
       <th scope="col" width="14%"><a href="demonstration.html"
 class="navigation">Demonstration</a></th>
      <th scope="col" bgcolor="#009933" width="14%"><FONT COLOR="#ffffff"><B>Documentation</B></FONT></th>
      <th scope="col" width="14%"><a href="examples.html"
 class="navigation">Examples</a></th>
      <th scope="col" width="14%"><a href="functions.html"
 class="navigation">Functions</a></th>
      <th scope="col" width="14%"><a href="contacts.html"
 class="navigation">Contacts</a></th>
    </tr>
  </tbody>
</table>
<!-- END OF HEADER --><!-- BODY -->
<h2><a name="overview"></a>Overview of methodology</h2>
<blockquote>
<p><b>Parametric fitting</b></p>
<p>The psychometric function underlying a given set of data is traditionally fitted by assuming that it has a standard shape, e.g. a Gaussian or Weibull function, and adjusting its parameters for best fit. The correct model function, however, is rarely known, and as a consequence, the fit may be biased, leading to incorrect inferences.</p>
<p>In parametric fitting, a psychometric function <i>P</i> is estimated by a generalized linear model with binomial distribution. The model for the psychometric function consists of a link function <i>l</i> (ensuring the response does not take impossible values) and a linear function of the stimulus levels <i>x</i>. The link function transforms the psychometric function to a linear function <i>η</i>; that is <i>l</i>(<i>P</i>(<i>x</i>)) = <i>η</i> = <i>a</i><sub>0</sub> + <i>a</i><sub>1</sub> <i>x</i>. Equivalently, <i>P</i>(<i>x</i>) = <i>l</i><sup> &ndash;1</sup>(<i>a</i><sub>0</sub> + <i>a</i><sub>1</sub> <i>x</i>). The link <i>l</i> is specified a priori, and it is defined by the chosen model function and the specified guessing and lapsing rates. For example, if the chosen model function is Gaussian and both guessing and lapsing rates are assumed to be zero, then the link function is simply the inverse of the Gaussian cumulative distribution function (see McCullagh and Nelder (1989), and Żychaluk and Foster (2009) <a href="software/papers/Zychaluk_Foster_PNP_09.pdf">Download PDF</a>). The parameters <i>a</i><sub>0</sub> and <i>a</i><sub>1</sub> are estimated by maximizing the log-likelihood,</p>

<p align="center"><i>l</i>(<i>a</i><sub>0</sub>, <i>a</i><sub>1</sub>) = ∑<sub><i>i</i></sub>[<i>k<sub>i</sub></i> ln(<i>P</i>(<i>x</i><i><sub>i</sub></i>)) + (<i>m<sub>i</sub></i><font color="#000000"><font face="Times New Roman, serif"><font size="3"><span style="font-weight: normal;"> – </span></font></font></font><i>k<sub>i</sub></i>) ln(1 <font color="#000000"><font face="Times New Roman, serif"><font size="3"><span style="font-weight: normal;">–</span></font></font></font> <i>P</i>(<i>x<sub>i</sub></i>))].
<p>The fit is strongly dependent on the chosen link function. The correct link function, however, is rarely known, and as a consequence, the ﬁt may be biased, leading to incorrect inferences.</p>

<p><b>Local linear fitting</b></p>
<p>Instead, the psychometric function can be modelled locally. The link function is still needed to ensure that the psychometric function does not take prohibited values but the function after transformation is no longer assumed to be linear. The only assumption is that it is smooth. By a Taylor expansion, any smooth function can be approximated locally by a linear function</p>
<p align="center"><i>l</i>(<i>P</i>(<i>x<sub>i</sub></i>)) = <i>η</i> ≈ <i>a</i><sub>0</sub> + <i>a</i><sub>1</sub> (<i>x<sub>i</sub></i> – <i>x</i>),</p>
<p>where the parameters <i>α</i><sub>0</sub>, <i>α</i><sub>1</sub> depend on <i>x</i> and their values are estimated by maximizing local log-likelihood,</p>
<p align="center"><i>l</i>(<i>x</i><sub></sub>) = ∑<sub><i>i</i></sub>[<i>k<sub>i</sub></i> ln(<i>P</i>(<i>x</i><i><sub>i</sub></i>)) + (<i>m<sub>i</sub></i> – <i>k<sub>i</sub></i>) ln(1 – <i>P</i>(<i>x<sub>i</sub></i>))] <i>w</i>(<i>x</i>,<i>x<sub>i</sub></i>).</p>
<p>The weights <span style="margin-bottom: 0.2cm"><i>w</i>(<i>x</i>,<i>x<sub>i</sub></i>)</span> determine the influence of each point <i>x<sub>i</sub></i> on the estimate at a point <i>x</i>, the further the points <i>x</i> and <i>x<sub>i</sub></i> are apart, the smaller the value of <i>w</i>(<i>x</i>,<i>x<sub>i</sub></i>).</p>
<p>The weight funciton is defined as <i>w</i>(<i>x</i>,<i>x<sub>i</sub></i>) = <i>K</i>((<i>x</i> – <i>x<sub>i</sub></i>)/<i>h</i>)/<i>h</i> for a kernel <i>K</i> and a bandwidth <i>h</i>. The kernel is a function usually assumed to be positive and symmetric about zero, e.g. a Gaussian function. It is known that the influence of the weight function <i>w</i> depends less on the shape of the kernel <i>K</i> than on the bandwidth <i>h</i>. The choice is crucial, as <i>h</i> controls the domain of influence of <i>w</i> and hence the smoothness of the local linear estimate. For small <i>h</i>, the estimate follows the data very closely and is therefore susceptible to the random variations in the data. For large <i>h</i>, the estimate is very smooth, close to that obtained by a parametric method, and therefore potentially biased.</p>
<p>To decide what is an optimal bandwidth, first the appropriate loss function needs to be chosen. This is a function which measures discrepancy between the true psychometric function and the estimate. The most commonly used measures are deviance (McCullagh and Nelder (1989),  Żychaluk and Foster (2009) <a href="software/papers/Zychaluk_Foster_PNP_09.pdf">Download PDF</a>) and integrated squared error (ISE),</p>
<p align="center">ISE(<i>&#285;</i>) = <i>&int;</i> (<i>g</i>(<i>x</i>)  – <i>&#285;</i>(<i>x</i>))<sup>2</sup> d<i>x</i>,</p>
<p>where <i>g</i> is the function of interest and <i>&#285;</i> the estimator of this function. Here, the ISE was considered both for the psychometric function <i>P</i> and for the function <i>η</i>. Thus there are three possible loss functions, i.e. the deviance, ISE for the psychometric function <i>P</i>, and ISE for the function <i>η</i>. There are three main methods of bandwidth choice available in this package: plug-in, cross-validation, and bootstrap. For each of these methods, there are three possible loss functions as explained above.</p>
<p>Finally, once the data have been fitted, there are several ways to assess the goodness of fit, such as the deviance or Pearson's <i>X</i><sup>2</sup>. With psychomet</font>ric functions, the responses are binomially distributed, but if they were normally distributed, then the deviance would coincide with the residual sum of squares.</p>
<p>A how-to guide to finding nonparametric estimates of psychometric functions with this package (MatLab option) follows.</p>
<p>McCullagh, P. and Nelder, J. A. <i>Generalized linear models</i>, 1989, London: Chapman &amp; Hall.</p> 
</blockquote>
<hr>
<h2><a name="loaddata"></a>Loading data from a text file</h2>
<blockquote>
<p>The data in a text file should be in</font> three columns, with no header: first column for stimulus levels, second for number of successes, and third for number of trials. Each line in the file should correspond to a stimulus level and the values should be separated by spaces. An example follows</p>
	<table border="0" cellpadding="2" cellspacing="0" width="40%">
		<tbody><tr>
			<td>
				<p><code>0.1 0 3<br>0.2 0 3<br>0.3 0 5<br>0.4 2 13<br>0.5 2
				10<br>0.6 2 20<br>0.7 2 14<br>0.9 3 11<br>1.1 4 5<br>1.3 18 20</code></p>
			</td>
		</tr>
	</tbody></table>
<p>To load the data in MatLab write</p>
	<table bgcolor="#ceffcf" border="1" cellpadding="2" cellspacing="0" width="100%">
		<tbody><tr>
			<td>
				<p><code>[ x, r, m ] = textread( '&lt;path\filename&gt;' );</code></p>
			</td>
		</tr>
	</tbody></table>
</blockquote>
<hr>
<h2><a name="savedata"></a>Save and Load data in MatLab format</h2>
<blockquote>
<p>To save the loaded data in MatLab format, type</p>
	<table bgcolor="#ceffcf" border="1" cellpadding="2" cellspacing="0" width="100%">
		<tbody><tr>
			<td>
				<p><code>save('&lt;path\filename&gt;', 'x', 'r', 'm');</code></p>
			</td>
		</tr>
	</tbody></table>

<p>The <code>filename</code> should have extension "<code>.mat</code>" or no extension. Once created it can be loaded by typing
<table bgcolor="#ceffcf" border="1" cellpadding="2" cellspacing="0" width="100%">
		<tbody><tr>
			<td>
				<p><code>load('&lt;path\filename&gt;');</code></p>
			</td>
		</tr>
	</tbody></table>
</blockquote>
<hr>
<h2><a name="locglmfit"></a>Local linear fitting</h2>
<blockquote>
<p>Local linear fitting is performed by the function <a href="functions/locglmfit.html"><code>locglmfit</code></a>. The arguments are <code>xfit</code> – points in which the function is to be estimated, <code>r</code> – the number of successful responses,<code>m</code> – the number of trials, <code>x</code> – stimulus levels, and <code>bwd</code> – bandwidth. The syntax is</p>
<table bgcolor="#ceffcf" border="1" cellpadding="2" cellspacing="0" width="100%">
		<tbody><tr>
			<td>
				<p><code>pfit = locglmfit( xfit, r, m, x, bwd );</code></p>
			</td>
		</tr>
	</tbody></table>
</blockquote>
<hr>
<h2><a name="bandwidth_selection"></a>Bandwidth selection</h2>
<blockquote>
<p>The selection of bandwidth is critical in local linear fitting. In this package there are three functions to select the bandwidth, <code><a href="functions/bandwidth_bootstrap.html">bandwidth_bootstrap</a></code>, <code><a href="functions/bandwidth_cross_validation.html">bandwidth_cross_validation</a></code>, and <code><a href="functions/bandwidth_plugin.html">bandwidth_plugin</a></code>. For all the methods, the number of successes <code>r</code> in <code>m</code> trials at each stimulus level <code>x</code> are mandatory parameters.</p>
<p>For the function <code><a href="functions/bandwidth_bootstrap.html">bandwidth_bootstrap</a></code> a search interval <code>bwdInterval</code> for the optimal bandwidth and the number of bootstrap replications are also mandatory. The syntax is</p>
	<table bgcolor="#ceffcf" border="1" cellpadding="2" cellspacing="0" width="100%">
		<tbody><tr>
			<td>
				<p><code>bwd = bandwidth_bootstrap( r, m, x, bwdInterval, replications );</code></p>
			</td>
		</tr>
	</tbody></table>
	
<p>For the function <code><a href="functions/bandwidth_cross_validation.html">bandwidth_cross_validation</a></code> a search interval <code>bwdInterval</code> for the optimal bandwidth is also mandatory. The syntax is</p>
	<table bgcolor="#ceffcf" border="1" cellpadding="2" cellspacing="0" width="100%">
		<tbody><tr>
			<td>
				<p><code>bwd = bandwidth_cross_validation( r, m, x, bwdInterval );</code></p>
			</td>
		</tr>
	</tbody></table>
<p>The function <code><a href="functions/bandwidth_plugin.html">bandwidth_plugin</a></code> calculates an estimate of the AMISE optimal bandwidth for the local polynomial estimator of a psychometric function. The syntax is</p>
	<table bgcolor="#ceffcf" border="2" cellpadding="2" cellspacing="0" width="100%">
		<col width="256*">
		<tbody><tr>
			<td width="100%">
				<p><code>bwd = bandwidth_plugin( r, m, x); </code>
				</p>
			</td>
		</tr>
	</tbody></table>
<p>An additional function, used only for testing purposes, is the function <code><a href="functions/bandwidth_optimal.html">bandwidth_optimal</a></code>. This function finds the actual optimal bandwidth for synthetic data
with known, true psychometric function <code>ptrue</code>. The arguments for this function are the same as for <code><a href="functions/bandwidth_cross_validation.html">bandwidth_cross_validation</a></code>, except that the true psychometric function <code> ptrue</code> is also required. The syntax is</p>
	<table bgcolor="#ceffcf" border="1" cellpadding="2" cellspacing="0" width="100%">
		<tbody><tr>
			<td>
				<p><code><font size="3">bwd = bandwidth_optimal( ptrue, r, m, x, bwdInterval );</font></code></p>
			</td>
		</tr>
	</tbody></table> 
</blockquote>
<hr>
<h2><a name="deviance"></a>Deviance</h2>
<blockquote>
<p>Calculates deviance <code>D</code> for data and fitted values of the psychometric function <code>pfit</code>.
The syntax is</p>
	<table bgcolor="#ceffcf" border="1" cellpadding="2" cellspacing="0" width="100%">
		<tbody><tr>
			<td>
				<p><code>D = deviance( r, m, pfit );</code></p>
			</td>
		</tr>
	</tbody></table>
</blockquote>
<hr>
<h2>Parametric fitting</h2>
<blockquote>
<p>The package also provides fits for several parametric models, such as Gaussian, Weibull, reverse Weibull, and logistic cumulative distribution functions. The parameters are estimated in functions <a href="functions/binomfit_lims.html"><code>binomfit_lims</code></a>, <code><a href="functions/binom_weib.html">binom_weib</a></code>, and <code><a href="functions/binom_revweib.html">binom_revweib</a></code>. The fitted values are obtained with the function <a href="functions/binomval_lims.html"><code>binomval_lims</code></a>.</p>
<p>To fit a logistic function and calculate the fitted values, the syntax is</p>
<table bgcolor="#ceffcf" border="2" cellpadding="2" cellspacing="0" width="100%">
		<col width="256*">
		<tbody><tr>
			<td width="100%">
				<code>b = binomfit_lims( r, m, x );<br>
                fest = binomval_lims( b, xfit );</code>
			</td>
		</tr>
	</tbody></table>
<p>To fit other functions, e.g. the Gaussian cumulative distribution, check the optional inputs of the function <code><a href="functions/binomfit_lims.html">binomfit_lims</a></code>.</p>
<p>To fit a Weibull function, the optimal exponent <code>K</code> for the Weibull needs to be estimated in addition to the linear coefficients <code>b</code>. To obtain the estimated psychometric function at values <code>xfit</code>, the guessing and 1-lapsing rate (in this example <code>[0,1]</code> are used) and the estimated exponent <code>K</code> need to be provided in <code><a href="functions/binomval_lims.html">binomval_lims</a></code>. The syntax is</p>
	<table bgcolor="#ceffcf" border="2" cellpadding="2" cellspacing="0" width="100%">
		<col width="256*">
		<tbody><tr>
			<td width="100%">
				<code>[ b, K ] = binom_weib( r, m, x );<br>
                fest = binomval_lims( b, xfit, 'weibull', [0,1], K );</code>
			</td>
		</tr>
	</tbody></table>
<p>To fit a reverse Weibull function and calculate the fitted values, replace the function <code><a href="functions/binom_weib.html">binom_weib</a></code> by <code><a href="functions/binom_revweib.html">binom_revweib</a></code> in the previous code and the parameter <code>'weibull'</code> by <code>'revweibull'</code> in the function <code><a href="functions/binomval_lims.html">binomval_lims</a></code>.</p>
</blockquote>
	<hr>
<h2><a name="otherOptions"></a>Link, kernel, and loss functions available</h2>
<blockquote style="text-align: left;">
  <p>A list of link functions
  available in the package follows.</p>
<ul>
    <li>logit</li>
  <li>probit</li>
<li>loglog</li>
<li>comploglog</li>
<li>weibull</li>
<li>revweibull</li>
</ul>
<p>A list of kernels available in the package follows. </p>
<ul>
  <li>normpdf</li>
<li>epanechikov</li>
<li>triangular</li>
<li>tricube</li>
<li>bisquare</li>
<li>uniform</li>
</ul>
<p>A list of loss functions
  available to obtain the optimal bandwidth by <code><a href="functions/bandwidth_bootstrap.html">bandwidth_bootstrap</a></code>,
  <code><a href="functions/bandwidth_cross_validation.html">bandwidth_cross_validation</a></code>,
  or <code><a href="functions/bandwidth_optimal.html">bandwidth_optimal</a></code>
  follows.</p>
<ul>
  <li>ISE: Integrated squared error</li>
<li>ISEeta: Integrated squared error on eta scale(eta is the function that is related to the psychometric function via the link function)</li>
<li>deviance function  </li>
</ul>
</blockquote>
<blockquote style="text-align: left;">Check the <a href="functions.html">Functions</a>
to see how to modify both links and kernels in the different
functions.</blockquote>
</body></html>