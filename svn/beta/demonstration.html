<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta name="Author" content="Ivan Marin-Franch">
  <meta name="Description"
 content="Nonparametric estimates of psychometric functions">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Nonparametric estimates of psychometric functions: Demonstration</title>
  <link href="styles.css" rel="stylesheet" type="text/css">
</head>
<body>
<table class="titleBox" cellpadding="0" cellspacing="0" width="100%">
  <tbody>
    <tr>
      <th scope="col" width="200"><img alt="logo"
 src="pictures/logo.jpg" style="width: 186px; height: 142px;"><br>
      </th>
      <th scope="col" bgcolor="#009933"> <h1 class="title" align="center">Model-free estimation of a psychometric function</h1>
          <blockquote>
            <h3 class="title" align="right"><script src="version.js" type="text/javascript"></script></h3>
          </blockquote></th>
    </tr>
    <tr> </tr>
  </tbody>
</table>
<table class="navigationBox" cellspacing="5" width="100%">
  <tbody>
    <tr>
      <th scope="col" width="14%"><a href="home.html"
 class="navigation">Home</a></th>
       <th scope="col" width="14%"><a href="downloads.html"
 class="navigation">Downloads</a></th>
      <th scope="col" bgcolor="#009933" width="14%"><FONT COLOR="#ffffff"><B>Demonstration</B></FONT></th>
      <th scope="col" width="14%"><a href="documentation.html"
 class="navigation">Documentation</a></th>
      <th scope="col" width="14%"><a href="examples.html"
 class="navigation">Examples</a></th>
      <th scope="col" width="14%"><a href="functions.html"
 class="navigation">Functions</a></th>
      <th scope="col" width="14%"><a href="contacts.html"
 class="navigation">Contacts</a></th>
    </tr>
  </tbody>
</table>
<!-- END OF HEADER --><!-- BODY -->
<h2>Local linear fitting for frequency-of-seeing data</h2>
<blockquote>
<p>Data were taken from a frequency-of-seeing experiment. A flash of light of variable intensity was presented repeatedly at a fixed location in the visual field of a subject who reported whether the flash was visible. </p>
<p>In this demonstration, a psychometric function is fitted to the data, a threshold for 50% seeing is estimated, and the corresponding slope of the function is also estimated.</p>

<p>After downloading and installing the MatLab package (<a href="downloads.html">here</a>), execute the following code to load the data.</p>

	<table bgcolor="#ceffcf" border="1" cellpadding="2" cellspacing="0" width="100%">
		<tbody><tr>
			<td>
            	<code>clear, load examples/01_Miranda;</code>
		  </td>
		</tr>
	</tbody></table>

<p>Alternatively, data can be loaded from a text file. This text file must have the structure as described in the <a href="documentation.html#loaddata">Documentation</a></p>
<table bgcolor="#ceffcf" border="1" cellpadding="2" cellspacing="0" width="100%">
		<tbody><tr>
			<td>
				<code>[ x, r, m ] = textread( 'examples/01_Miranda.txt' );</code>
		  </td>
		</tr>
	</tbody>
</table>

<p>The loaded MatLab data consist of three columns, the stimulus level <code>x</code>, the number of successes <code>r</code>, and the number of trials <code>m</code>.
In this example</p>

<center>
  <table width="154" border="0" align="center" cellpadding="0" cellspacing="0" bordercolor="#000000">
    <tr>
      <th height="28" valign="top" scope="col"><code>x</code></th>
      <th height="28" valign="top" scope="col"><code>r</code></th>
      <th height="28" valign="top" scope="col"><code>m</code></th>
    </tr>
    <tr>
      <td align="center"><code>0.1</code></td>
      <td align="center"><code>0</code></td>
      <td align="center"><code>3</code></td>
    </tr>
    <tr>
      <td align="center"><code>0.2</code></td>
      <td align="center"><code>0</code></td>
      <td align="center"><code>3</code></td>
    </tr>
    <tr>
      <td align="center"><code>0.3</code></td>
      <td align="center"><code>0</code></td>
      <td align="center"><code>5</code></td>
    </tr>
    <tr>
      <td align="center"><code>0.4</code></td>
      <td align="center"><code>2</code></td>
      <td align="center"><code>13</code></td>
    </tr>
    <tr>
      <td align="center"><code>0.5</code></td>
      <td align="center"><code>2</code></td>
      <td align="center"><code>10</code></td>
    </tr>
    <tr>
      <td align="center"><code>0.6</code></td>
      <td align="center"><code>2</code></td>
      <td align="center"><code>20</code></td>
    </tr>
    <tr>
      <td align="center"><code>0.7</code></td>
      <td align="center"><code>2</code></td>
      <td align="center"><code>14</code></td>
    </tr>
    <tr>
      <td align="center"><code>0.9</code></td>
      <td align="center"><code>3</code></td>
      <td align="center"><code>11</code></td>
    </tr>
    <tr>
      <td align="center"><code>1.1</code></td>
      <td align="center"><code>4</code></td>
      <td align="center"><code>5</code></td>
    </tr>
    <tr>
      <td align="center"><code>1.3</code></td>
      <td align="center"><code>18</code></td>
      <td align="center"><code>20</code></td>
    </tr>
  </table>
</center>

<p>An important part of local linear fitting is the choice of bandwidth <code>bwd</code>. This is done here automatically using the following code, which delivers three estimates. Only the last one is used. If you want to exercise more choice, then go to <a href="Documentation.html#bandwidth_selection">bandwidth selection</a>.</p>
	<table bgcolor="#ceffcf" border="1" cellpadding="2" cellspacing="0" width="100%">
		<tbody><tr>
			<td><code>bwd_min = min( diff( x ) );<br>
                      bwd_max = max( x ) - min( x );<br>
                      bwd = bandwidth_cross_validation( r, m, x, [ bwd_min, bwd_max ] );<br>
                      bwd = bwd(3); % choose the third estimate based on cross-validated deviance</code></td>
		</tr>
	</tbody>
</table>

<p>Next define the set of x-values <code>xfit</code> for the psychometric function (in fact, they can be the same as the x-values for the data set) and the estimated values <code>pfit</code> at those x-values.</p>
	<table bgcolor="#ceffcf" border="1" cellpadding="2" cellspacing="0" width="100%">
		<tbody><tr>
			<td><code>numxfit = 999; % Number of points to be generated minus 1<br>
                      xfit = [min( x ):(max(x)-min(x))/numxfit:max( x )]'; % Values of x at which to estimate the psychometric function<br>
                      pfit = locglmfit( xfit, r, m, x, bwd );</code></td>
		</tr>
	</tbody></table>

<p>Finally, get the threshold and slope (and their standard deviations) at the criterion 50%-seeing level of <code>p = 0.5</code>, and make a plot.</p>

	<table bgcolor="#ceffcf" border="1" cellpadding="2" cellspacing="0" width="100%">
		<tbody><tr>
			<td>
				<code>prob = 0.5; % probability where to estimate the threshold and slope<br>
                [ threshold, slope ] = threshold_slope( pfit, xfit, prob );<br>
                      niter = 200; % Number of bootstrap iterations<br>
                      sd_th = bootstrap_sd_th( prob, r, m, x, niter, bwd ); % Be patient, slow process<br>
                      sd_sl = bootstrap_sd_sl( prob, r, m, x, niter, bwd ); % Be patient, slow process<br>
                      figure; plot( x, r ./ m, 'k.'); axis([0.05 1.35 -0.02 1]); axis square;<br>
                      hold on, plot( xfit, pfit, 'k' )</code></td>
		</tr>
	</tbody>
</table>
    
    <p>The results delivered by MatLab should be as follows. Note that the estimated standard deviations (sd) will vary a little from evaluation to evaluation.</p>
  <ul>
    <li><code>threshold (sd) = </code>0.9745 (0.0558)</li>
    <li><code>slope (sd) = </code>1.5536 (0.2941)</li>
  </ul>

<img src="pictures/replicationFig02_PNP.png" name="graphics2" alt="Image not found" align="bottom" border="0" height="420" width="561">

<p>The complete example for frequency of seeing is given in <a href="examples/example01.html">example01</a>.</p>

</blockquote>

<hr>
<h2>Next steps</h2>
<blockquote>
<p>To look at other examples, click&nbsp; <a href="examples.html">here</a>, all taken from Å»ychaluk K. &amp; Foster, D. H. (2009). <a href="software/papers/Zychaluk_Foster_PNP_09.pdf">Download PDF</a>.</p>
<p>To learn more about how the package works, go to <a href="Documentation.html">Documentation</a>.</p>
<p>To get a complete list of functions used in this package,
  go to <a href="functions.html">Functions</a>.</p>
<p>To get a brief description of nonparametric fitting, goto <a href="Documentation.html">Documentation</a>. </p>
<p>To get source publications and contact details of the authors, go to <a href="contacts.html">Contacts</a>.</p>
</blockquote>
</body>
</html>