<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta name="Author" content="Ivan Marin-Franch">
  <meta name="Description"
 content="Nonparametric estimates of psychometric functions">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Nonparametric estimates of psychometric functions: Examples</title>
  <link href="../styles.css" rel="stylesheet" type="text/css">
</head>
<body>
<table class="titleBox" cellpadding="0" cellspacing="0" width="100%">
  <tbody>
    <tr>
      <th scope="col" width="200"><img alt="logo"
 src="../pictures/logo.jpg" style="width: 186px; height: 142px;"><br>
      </th>
      <th scope="col" bgcolor="#009933"> <h1 class="title" align="center">Model-free estimation of a psychometric function</h1>
          <blockquote>
            <h3 class="title" align="right"><script src="../version.js" type="text/javascript"></script></h3>
          </blockquote></th>
    </tr>
    <tr> </tr>
  </tbody>
</table>
<table class="navigationBox" cellspacing="5" width="100%">
  <tbody>
    <tr>
      <th scope="col" width="14%"><a href="../home.html"
 class="navigation">Home</a></th>
       <th scope="col" width="14%"><a href="../downloads.html"
 class="navigation">Downloads</a></th>
       <th scope="col" width="14%"><a href="../demonstration.html"
 class="navigation">Demonstration</a></th>
      <th scope="col" width="14%"><a href="../documentation.html"
 class="navigation">Documentation</a></th>
      <th scope="col" bgcolor="#009933" width="14%"><FONT COLOR="#ffffff"><B>Examples</B></FONT></th>
      <th scope="col" width="14%"><a href="../functions.html"
 class="navigation">Functions</a></th>
      <th scope="col" width="14%"><a href="../contacts.html"
 class="navigation">Contacts</a></th>
    </tr>
  </tbody>
</table>
<!-- END OF HEADER --><!-- BODY -->
<h2>Example 1. Frequency of seeing</h2>
<blockquote>
  <p>Miranda, M. A. &amp; Henson, D. B. “Perimetric sensitivity and response variability in glaucoma with single-stimulus automated perimetry and multiple-stimulus perimetry with verbal feedback”, Acta Ophthalmologica, 86, 202-206, 2008.</p>
  <table width="25%" cellspacing="5" class="navigationBox2">
    <tr>
      <th bgcolor="#009933" class="title" scope="col">MatLab</th>
      <th width="50%" scope="col" class="navigation"><a href="example01R.html" class="navigation">R</a></th>
    </tr>
  </table>
  <p><A HREF="../examples.html#seeing">Back to Examples</A></p>
<p>A flash of light of variable intensity was presented repeatedly at a fixed location in the visual field of a subject who reported whether the flash was visible. There were 3–20 trials at each stimulus level.</p>
<p><STRONG>Load data</STRONG></p>
	<TABLE WIDTH=100% BORDER=1 CELLPADDING=2 CELLSPACING=0 BGCOLOR="#ceffcf">
		<TR>
			<TD>
				<P><CODE><FONT COLOR="#000000">clear, load examples/example_01;</FONT></CODE></P>			</TD>
		</TR>
	</TABLE>
  <p>Loaded MatLab <CODE>data</CODE> consist of three columns:</p>
  <ol>
    <li>Stimulus level, <CODE>x</CODE></li>
    <li>Number of successes, <CODE>r</CODE></li>
    <li>Number of trials, <CODE>m</CODE></li>
  </ol>
<STRONG>Parametric fitting</STRONG>
<p>Four different parametric models are fitted to these data: Gaussian (probit), Weibull, reverse Weibull and logistic. The parameters of the models are estimated in the Matlab functions <code>binomfit_lims</code> for the probit and logit links. The other two models require an estimate of the exponent <code>K</code> and the estimation is performed in the functions <code>binom_weib</code> and <code>binom_revweib</code>. The values of the fitted functions at specified points are calculated in the function
<code>binomval_lims</code>.</p>
<p>First plot the psychometric data (black dots):</p>
	<TABLE WIDTH=100% BORDER=1 CELLPADDING=2 CELLSPACING=0 BGCOLOR="#ceffcf">
		<TR>
			<TD><CODE>figure; plot( x, r ./ m, 'k.'); axis([0.05 1.35 -0.02 1]); axis square;</CODE></TD>
		</TR>
	</TABLE>
 <p>1. For the Gaussian cumulative distribution function (black curve):</p>
<TABLE WIDTH=100% BORDER=1 CELLPADDING=2 CELLSPACING=0 BGCOLOR="#ceffcf">
		<TR>
			<TD>
            <code>degpol = 1; % Degree of the polynomial<BR>b = binomfit_lims( r, m, x, degpol, 'probit' );<br>
                  numxfit = 999; % Number of points to be generated minus 1<br>
                  xfit = [min( x ):(max(x)-min(x))/numxfit:max( x )]';<br>
                  % Plot the fitted curve<br>
                  pfit = binomval_lims( b, xfit, 'probit' );<br>
                  hold on, plot( xfit, pfit, 'k' );</CODE>
            </TD>
		</TR>
	</TABLE>
<p>2. For the Weibull function (red curve):</p>
	<TABLE WIDTH=100% BORDER=1 CELLPADDING=2 CELLSPACING=0 BGCOLOR="#ceffcf">
		<TR>
			<TD>
				<CODE>[ b, K ] = binom_weib( r, m, x );<BR>
                guessing = 0; % guessing rate<br>
				lapsing = 0; % lapsing rate<BR>
				% Plot the fitted curve<BR>
                pfit = binomval_lims( b, xfit, 'weibull', guessing, lapsing, K );<BR>
				hold on, plot( xfit, pfit, 'r' );</CODE>
			</TD>
		</TR>
	</TABLE>
<p>3. For the reverse Weibull function (green curve):</p>
	<TABLE WIDTH=100% BORDER=1 CELLPADDING=2 CELLSPACING=0 BGCOLOR="#ceffcf">
		<TR>
			<TD>
				<CODE>[ b, K ] = binom_revweib( r, m, x );<BR>
                % Plot the fitted curve<BR>
                pfit = binomval_lims( b, xfit, 'revweibull', guessing, lapsing, K );<BR>
				hold on, plot( xfit, pfit, 'g' );</CODE>
            </TD>
		</TR>
	</TABLE>
<p>4. For the logistic function (blue curve):</p>
	<TABLE WIDTH=100% BORDER=1 CELLPADDING=2 CELLSPACING=0 BGCOLOR="#ceffcf">
		<TR>
			<TD>
				<CODE>b = binomfit_lims( r, m, x, degpol, 'logit' );<BR>
                % Plot the fitted curve<BR>
                pfit = binomval_lims( b, xfit, 'logit' );<BR>
				hold on, plot( xfit, pfit, 'b' );</CODE>
            </TD>
		</TR>
	</TABLE>
    <IMG SRC="../pictures/replicationFig01_PNP.png" NAME="graphics2" ALT="Image not found">
<p><STRONG>Local linear fitting</STRONG></p>
<p>Local linear fitting is performed in the function <code>locglmfit</code>, which returns the fitted values at specified points. This function requires a bandwidth as an input. The bandwidth <code>bwd</code> is typically chosen by a cross-validation. There are three different loss functions used in cross-validation: ISE defined on a <i>p</i>-scale, ISE defined on an eta-scale, and deviance.</p>
	<TABLE WIDTH=100% BORDER=1 CELLPADDING=2 CELLSPACING=0 BGCOLOR="#ceffcf">
		<TR>
			<TD>
				<P><CODE>bwd_min = min( diff( x ) );<BR>bwd_max = max( x ) - min(
				x );<BR>bwd = bandwidth_cross_validation( r, m, x, [ bwd_min,
				bwd_max ] );</CODE></P>			</TD>
		</TR>
	</TABLE>
<p>The values of cross-validation bandwidths are</p>
  <ul>
    <li><CODE>bwd = 0.1000</CODE> for ISE on a <I>p</I>-scale,</li>
    <li><CODE>bwd = 0.3128</CODE> for ISE defined on an eta-scale,</li>
    <li><CODE>bwd = 0.2959</CODE> for deviance.</li>
  </ul>
<p>Here, the bandwidth obtained with cross-validated deviance is used.</p>
	<TABLE WIDTH=100% BORDER=1 CELLPADDING=2 CELLSPACING=0 BGCOLOR="#ceffcf">
		<TR>
			<TD>
				<P><CODE>bwd = bwd(3); % Choose the third estimate, which is based on cross-validated deviance<BR>
                pfit = locglmfit( xfit, r, m, x, bwd );<BR>
                figure; plot( x, r ./ m, 'k.'); axis([0.05 1.35 -0.02 1]); axis square;<BR>
				hold on, plot( xfit, pfit, 'k' );</CODE>
            </TD>
		</TR>
	</TABLE>
<IMG SRC="../pictures/replicationFig02_PNP.png" NAME="graphics3" ALT="Image not found">
<p>From the fitted values of the psychometric function, the threshold and slope for a requied threshold level, here <code>prob</code> = 0.5, are calculated in the function <code>threshold_slope</code>. The functions <code>bootstrap_sd_th</code> and
<code>bootstrap_sd_sl</code> estimate their standard deviations by the percentile bootstrap method. In the following example, 200 bootstrap replications were used. Note that these functions, as with all bootstrap methods, return similar but slightly different values at each execution. </p>
	<TABLE WIDTH=100% BORDER=1 CELLPADDING=2 CELLSPACING=0 BGCOLOR="#ceffcf">
		<TR>
			<TD>
				<CODE>prob = 0.5; % Required threshold level<BR>
                niter = 200; % Number of bootstrap iterations<BR>
                [ threshold, slope ] = threshold_slope( pfit, xfit, prob );<BR>
                sd_th = bootstrap_sd_th( prob, r, m, x, niter, bwd ); % Be patient, slow process<BR>
                sd_sl = bootstrap_sd_sl( prob, r, m, x, niter, bwd ); % Be patient, slow process</CODE>
            </TD>
		</TR>
	</TABLE>
<p>Examples of values returned by MatLab are as follows:</p>
  <ul>
    <li><CODE>threshold (sd_th) = 0.9745 (0.0558)</code></li>
    <li><CODE>slope (sd_sl) = 1.5536 (0.2941)</CODE></li>
  </ul>
  <p>Bootstrap estimates of confidence intervals for the threshold and slope are calculated by the functions <code>bootstrap_ci_th</code> and <code>bootstrap_ci_sl;</code> here a significance level <code>alpha</code> = 0.05 was used. Again, the these functions return similar but slightly different values at each execution.</p>
	<TABLE WIDTH=100% BORDER=1 CELLPADDING=2 CELLSPACING=0 BGCOLOR="#ceffcf">
		<TR>
			<TD>
				<CODE>prob = 0.5; % Required threshold level<BR>
                alpha = 0.05; % Significance level for the confidence intervals<BR>
                niterci = 1000; % Number of bootstrap iterations<BR>
                ci_th = bootstrap_ci_th( prob, r, m, x, niterci, bwd, alpha); % Be patient, slow process<BR>
                ci_sl = bootstrap_ci_sl( prob, r, m, x, niterci, bwd, alpha ); % Be patient, slow process</CODE>
   			</TD>
		</TR>
	</TABLE>
<p>Examples of confidence intervals returned by MatLab are as follows:</p>
  <ul>
    <li><CODE>ci_th = [0.8363,1.0538];</CODE></li>
    <li><CODE>ci_sl = [0.9863,2.1536];</CODE> </li>
  </ul>
<A HREF="../examples.html#seeing">Back to Examples</A></BLOCKQUOTE>
</blockquote>
</body>
</html>